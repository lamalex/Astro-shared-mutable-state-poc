---
import type { FootnoteRegistry } from '../lib/footnote-registry';

export interface Props {
  id: string;
  registry?: FootnoteRegistry;
  defer?: boolean;
}

const { id, registry, defer = false } = Astro.props;

if (!registry) {
  throw new Error('FootnoteRef component requires a registry prop');
}

// Register the footnote and get the number
const footnoteNumber = registry.register(id, defer);
---

<sup>
  <a 
    href={`#footnote-${id}`} 
    id={`footnote-ref-${id}`} 
    class="footnote-ref"
    data-footnote-id={id}
    data-deferred={defer ? 'true' : 'false'}
  >
    {footnoteNumber}
  </a>
</sup>

<style>
  .footnote-ref {
    text-decoration: none;
    color: #0066cc;
    font-weight: 500;
  }
  
  .footnote-ref:hover {
    text-decoration: underline;
  }
</style>